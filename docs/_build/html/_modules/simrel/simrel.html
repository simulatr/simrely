

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>simrel.simrel &mdash; simrel 0.5.5 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="simrel 0.5.5 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> simrel
          

          
          </a>

          
            
            
              <div class="version">
                0.5.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../simrel.html">simrel package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">simrel</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>simrel.simrel</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for simrel.simrel</h1><div class="highlight"><pre>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    simrel</span>
<span class="sd">    ~~~~~~~~~~~</span>
<span class="sd">    This simrel library can be used to simulate a linear model data with 1, 2, or many response variables.</span>
<span class="sd">    With few parameters, simrel can simulate data with wide range of properties. The parameters will be discussed</span>
<span class="sd">    more in discription of relevant classes</span>
<span class="sd">    :copyright: (c) 2018 by Raju Rimal</span>
<span class="sd">    :license: MIT, see LICENSE for more details.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">utilities</span> <span class="kn">import</span> <span class="o">*</span>


<span class="c1"># noinspection PyUnresolvedReferences</span>
<div class="viewcode-block" id="Simrel"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Simrel">[docs]</a><span class="k">class</span> <span class="nc">Simrel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class only containing common parameters and methods to compute common</span>
<span class="sd">    properties</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Take parameters from the initiated object and set some of those as an</span>
<span class="sd">        attributes of the object itself. These attributes will also be used by</span>
<span class="sd">        some of the methods for computing properties of simrel object</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -------------</span>
<span class="sd">        **kwargs :</span>
<span class="sd">            All the possible parameters values accepted by their name. The individual child class will discuss on the arguments in details.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;nobs&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>  <span class="c1"># Number of observations</span>
            <span class="s1">&#39;npred&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>  <span class="c1"># Number of predictors</span>
            <span class="s1">&#39;nrelpred&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>  <span class="c1"># Number of relevant predictors</span>
            <span class="s1">&#39;relpos&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>  <span class="c1"># Position of relevant predictor components</span>
            <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>  <span class="c1"># Decay factor of eigenvalue of predictor</span>
            <span class="s1">&#39;rsq&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>  <span class="c1"># Coefficient of determination</span>
            <span class="s1">&#39;sim_type&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>  <span class="c1"># Type of simulation: univariate, bivariate, multivariate</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="Simrel.get_eigen"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Simrel.get_eigen">[docs]</a>    <span class="k">def</span> <span class="nf">get_eigen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute eigenvalues based on the ``gamma`` or ``eta`` parameters using following expression</span>
<span class="sd">            </span>
<span class="sd">            For predictor:</span>

<span class="sd">            math:: \lambda_i = e^{-\gamma(i - 1)}, \gamma &gt;0 \text{ and } i = 1, 2, \ldots, p</span>

<span class="sd">            For response:</span>

<span class="sd">            math:: \kappa_j = e^{-\eta(j - 1)}, \eta &gt;0 \text{ and } j = 1, 2, \ldots, m</span>
<span class="sd">        </span>
<span class="sd">        predictor : </span>
<span class="sd">            Computes eigenvalues of predictor is true using ``gamma`` paramters else computes eigenvalues corresponding to response using ``eta`` parameters, defaults to True (&#39;predictors&#39;)</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An array</span>
<span class="sd">            Eigenvalues equals to the length of number of predictor/response</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">predictor</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">vec_</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npred</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">fctr_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vec_</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nresp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">fctr_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span>
        <span class="n">eigen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">([</span><span class="o">-</span><span class="n">fctr_</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">p_</span><span class="p">)</span> <span class="k">for</span> <span class="n">p_</span> <span class="ow">in</span> <span class="n">vec_</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fctr_</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">eigen</span></div>

<div class="viewcode-block" id="Simrel.get_sigmaz"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Simrel.get_sigmaz">[docs]</a>    <span class="k">def</span> <span class="nf">get_sigmaz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute variance-covariance matrix of latent components of predictors</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An array</span>
<span class="sd">            A diagonal matrix (as array data-type) with eigenvalues of predictors in its diagonal</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigen_x</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_eigen</span><span class="p">()</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigen_x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Simrel.get_sigmaw"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Simrel.get_sigmaw">[docs]</a>    <span class="k">def</span> <span class="nf">get_sigmaw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute variance-covariance matrix of latent components of response</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An array</span>
<span class="sd">            A diagonal matrix (as array data-type) with eigenvalues of responses in its diagonal</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigen_y</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_eigen</span><span class="p">(</span><span class="n">predictor</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eigen_y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Simrel.get_sigmazinv"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Simrel.get_sigmazinv">[docs]</a>    <span class="k">def</span> <span class="nf">get_sigmazinv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the inverse of ``sigmaz`` (eigenvalue matrix of predictors) just by taking inverse of eigenvalues</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A numpy array</span>
<span class="sd">            Diagonal matrix in an array data type is returned as an inverse of ``sigma_z``</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigen_x</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_eigen</span><span class="p">(</span><span class="n">predictor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigen_x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Simrel.get_sigma"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Simrel.get_sigma">[docs]</a>    <span class="k">def</span> <span class="nf">get_sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Concatinate the variance and variance-covariance matrices</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An array</span>
<span class="sd">            An array as a variance-covariance matrix of joint distribution of responses and predictors</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;sigma_zw&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_sigma_zw</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;sigmaw&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_sigmaw</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;sigmaz&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_sigmaz</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span>
            <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_zw</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_zw</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_z</span><span class="p">))</span>
        <span class="p">))</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Simrel.get_relpred"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Simrel.get_relpred">[docs]</a>    <span class="k">def</span> <span class="nf">get_relpred</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes (identifies) the position of relevant and irrelevant positions of predictor variables. Since the number of relevant predictors are given in argument ``q``, it will use position specified in ``relpos`` and sample remaining position from total availiable position to fill ``q``.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A dictionary</span>
<span class="sd">            With two elements: ``irrel`` contains a list of irrelevant positon and ``rel`` contains list of list of relevant positions corresponding to each response variables (components)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">predpos_</span> <span class="o">=</span> <span class="n">predpos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npred</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nrelpred</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">relpos</span><span class="p">])</span>
        <span class="n">irrelpred</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">predpos_</span><span class="p">[</span><span class="s1">&#39;irrel&#39;</span><span class="p">])</span>
        <span class="n">relpred</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">predpos_</span><span class="p">[</span><span class="s1">&#39;rel&#39;</span><span class="p">]]</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">irrel</span><span class="o">=</span><span class="n">irrelpred</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="n">relpred</span><span class="p">)</span></div>

<div class="viewcode-block" id="Simrel.get_data"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Simrel.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Uses ``simulate`` utility function to simulate data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -------------</span>

<span class="sd">        data_type : {character}</span>
<span class="sd">            Can take values: ``train``, ``test`` or ``both``. If only ``train`` is specified will only simulate training samples even if number of test observation is specified in the argument</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        A dictionary with pandas DataFrame</span>
<span class="sd">            The dictionary contains two elements at most: ``train`` and ``test`` each as pandas DataFrame. The DataFrame contains ``nobs`` (for training) and ``ntest`` (for test) samples observation with columns with names ``Y1``, ``Y2`` so on for response and ``X1``, ``X2`` and so on for predictors</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
        <span class="c1"># Check for positive definite of sigma</span>
        <span class="n">nobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nobs</span>
        <span class="n">npred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npred</span>
        <span class="n">nresp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nresp</span>
        <span class="n">rotation_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_x</span>
        <span class="n">rotation_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_y</span>
        <span class="n">mu_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_x</span>
        <span class="n">mu_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_y</span>
        <span class="n">ntest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ntest</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">]:</span>
            <span class="n">out</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">nobs</span><span class="p">,</span> <span class="n">npred</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rotation_x</span><span class="p">,</span> <span class="n">nresp</span><span class="p">,</span> <span class="n">rotation_y</span><span class="p">,</span> <span class="n">mu_x</span><span class="p">,</span> <span class="n">mu_y</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">ntest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">ntest</span><span class="p">,</span> <span class="n">npred</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rotation_x</span><span class="p">,</span> <span class="n">nresp</span><span class="p">,</span> <span class="n">rotation_y</span><span class="p">,</span> <span class="n">mu_x</span><span class="p">,</span> <span class="n">mu_y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div></div>


<div class="viewcode-block" id="Unisimrel"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Unisimrel">[docs]</a><span class="k">class</span> <span class="nc">Unisimrel</span><span class="p">(</span><span class="n">Simrel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is responsible for uniresponse simulation, i.e. with one response variable. This is heaviely dependent of the properties and methods of its parent class. The parameters required for this class are as follows:</span>

<span class="sd">    PARAMETERS</span>
<span class="sd">    ------------</span>

<span class="sd">    nobs: integer</span>
<span class="sd">        100 (default) Number of training observations to simulate</span>

<span class="sd">    npred: integer</span>
<span class="sd">        20 (default) Number of predictor variables</span>

<span class="sd">    nrelpred: a list</span>
<span class="sd">        7 (default) Number of relevant predictor the the response variable</span>

<span class="sd">    relpos: a list</span>
<span class="sd">        [1, 3, 4, 6] (default) Position of relevant components for the response</span>

<span class="sd">    gamma: float</span>
<span class="sd">        0.8 (default) Exponential decay factor of eigenvalues corresponding to predictors</span>

<span class="sd">    rsq: list</span>
<span class="sd">        0.8 (default) Coefficient of determination</span>

<span class="sd">    sim_type: string</span>
<span class="sd">        &#39;univariate&#39; (default) Can only take this value for this class</span>

<span class="sd">    ntest: integer</span>
<span class="sd">        None (default) Number of test observations</span>

<span class="sd">    mu_x: list</span>
<span class="sd">        None (default) A list of average values for each predictor variable</span>

<span class="sd">    mu_y: list</span>
<span class="sd">        None (default) A list with average value for the response. In this case it will be a list  of one element</span>

<span class="sd">    RETURNS</span>
<span class="sd">    --------</span>

<span class="sd">    class</span>
<span class="sd">        A simrel class</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nobs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">npred</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">nrelpred</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">relpos</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                 <span class="n">gamma</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">rsq</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">sim_type</span><span class="o">=</span><span class="s1">&#39;univariate&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This function initilize all the arguments and also compute properties when the object is initiated. However this will not simulate the data. To simulate the data from using the computed properties, one need to use ``get_data`` method.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Assigning Attributes which might get replaced when calling parent constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu_x</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu_y</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ntest</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nresp</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Calling for parent constructor</span>
        <span class="n">Simrel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nobs</span><span class="o">=</span><span class="n">nobs</span><span class="p">,</span> <span class="n">npred</span><span class="o">=</span><span class="n">npred</span><span class="p">,</span> <span class="n">nrelpred</span><span class="o">=</span><span class="n">nrelpred</span><span class="p">,</span> <span class="n">rsq</span><span class="o">=</span><span class="n">rsq</span><span class="p">,</span>
                        <span class="n">relpos</span><span class="o">=</span><span class="n">relpos</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">nresp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nresp</span><span class="p">,</span> <span class="n">sim_type</span><span class="o">=</span><span class="n">sim_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Assigning more attributes to unisimrel class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eta</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Lets start computing different properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotation_y</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigen_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_eigen</span><span class="p">(</span><span class="n">predictor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigen_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_eigen</span><span class="p">(</span><span class="n">predictor</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sigmaz</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_zinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sigmazinv</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sigmaw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_zw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sigma_zw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sigma</span><span class="p">()</span>
        <span class="n">relpred_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_relpred</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relpred</span> <span class="o">=</span> <span class="n">relpred_</span><span class="p">[</span><span class="s1">&#39;rel&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irrelpred</span> <span class="o">=</span> <span class="n">relpred_</span><span class="p">[</span><span class="s1">&#39;irrel&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotation_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_pred</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_beta_z</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_beta</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_beta0</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rsq_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rsq_y</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minerror</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minerror</span><span class="p">()</span>

<div class="viewcode-block" id="Unisimrel.get_sigma_zw"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Unisimrel.get_sigma_zw">[docs]</a>    <span class="k">def</span> <span class="nf">get_sigma_zw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the covariance between principal components of predictors and response variable satisfying all the input value of ``relpos``, ``rsq``, ``npred`` and ``gamma``</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        A numpy array</span>
<span class="sd">            The array with dimension of ``nresp`` (1) by ``npred`` containing non-zero elements at the position of relevant components and zero at other places.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;eigen_x&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_eigen</span><span class="p">(</span><span class="n">predictor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">sigma_zw</span> <span class="o">=</span> <span class="n">get_cov</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relpos</span><span class="p">,</span> <span class="n">rsq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">,</span>
                           <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">npred</span><span class="p">,</span> <span class="n">lmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eigen_x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sigma_zw</span></div>

<div class="viewcode-block" id="Unisimrel.rotate_pred"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Unisimrel.rotate_pred">[docs]</a>    <span class="k">def</span> <span class="nf">rotate_pred</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A rotation matrix for predictor is generated. This rotation matrix is used as a eigenvector matrix which will rotates the principal components to obtain predictor variables.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        A numpy array</span>
<span class="sd">            The arrary will of of size ``npred`` times ``npred``. </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">relpred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relpred</span>
        <span class="n">npred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npred</span>
        <span class="n">irrelpred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">irrelpred</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">npred</span><span class="p">)</span>
        <span class="n">rot_rel</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_rotate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">relpred</span><span class="p">]</span>
        <span class="n">rot_irrel</span> <span class="o">=</span> <span class="n">get_rotate</span><span class="p">(</span><span class="n">irrelpred</span><span class="p">)</span>
        <span class="n">out</span><span class="p">[[[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irrelpred</span><span class="p">],</span> <span class="p">[</span><span class="n">irrelpred</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rot_irrel</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">relpred</span><span class="p">)):</span>
            <span class="n">out</span><span class="p">[[[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">relpred</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="p">[</span><span class="n">relpred</span><span class="p">[</span><span class="n">k</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">rot_rel</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Unisimrel.get_beta_z"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Unisimrel.get_beta_z">[docs]</a>    <span class="k">def</span> <span class="nf">get_beta_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Regression coefficients corresponding to principal components.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        A numpy array</span>
<span class="sd">            The array contains non-zero regression coefficints where the components are relevant and zero otherwise</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_zinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_zw</span><span class="p">)</span></div>

<div class="viewcode-block" id="Unisimrel.get_beta"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Unisimrel.get_beta">[docs]</a>    <span class="k">def</span> <span class="nf">get_beta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Regression coefficients corresponding to the simulated data</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        A numpy array</span>
<span class="sd">            An array of true regression coefficient of size equals to ``npred``.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_z</span><span class="p">)</span></div>

<div class="viewcode-block" id="Unisimrel.get_beta0"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Unisimrel.get_beta0">[docs]</a>    <span class="k">def</span> <span class="nf">get_beta0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Intercept term</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        An array</span>
<span class="sd">            The array contains the intercept terms of the regression model. The default is zero if both ``mu_y`` and ``mu_x`` are None. In this particular class, the array only contains one element</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">beta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nresp</span><span class="p">,))</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="n">beta0</span> <span class="o">=</span> <span class="n">beta0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_y</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">beta0</span>
        <span class="n">beta0</span> <span class="o">=</span> <span class="n">beta0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">beta</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">beta0</span>
        <span class="k">return</span> <span class="n">beta0</span></div>

<div class="viewcode-block" id="Unisimrel.get_rsq_y"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Unisimrel.get_rsq_y">[docs]</a>    <span class="k">def</span> <span class="nf">get_rsq_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the coefficient of determination from ``beta_z`` and ``sigma_zw``. This is the true coefficient of simulated data which will resembles input ``rsq`` parameter</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        An array</span>
<span class="sd">            The array contains single element containing coefficient of determination for the response variable</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_z</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_zw</span><span class="p">)</span></div>

<div class="viewcode-block" id="Unisimrel.get_minerror"><a class="viewcode-back" href="../../simrel.html#simrel.simrel.Unisimrel.get_minerror">[docs]</a>    <span class="k">def</span> <span class="nf">get_minerror</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Minimum error of the model, for this uniresponse simulation it is the difference between total variation in response ``sigma_w`` and coefficient of determination ``rsq_y``</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        An array</span>
<span class="sd">            For this uniresponse simulation it only contains one element</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsq_y</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Raju Rimal.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.5.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>